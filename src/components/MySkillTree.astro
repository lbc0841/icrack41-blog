---
import {
    EasyEdaIcon,
    PencilIcon,
    AstroIcon,
    BlenderIcon,
    GitIcon,
    AndroidStudioIcon,
    Printer3dIcon,
    VsCodeIcon,
    SolderIcon,
    UltimakerCuraIcon,
} from "../assets/icons.jsx";

import { Border2 } from "../assets/borders.tsx";

let icon_size = 50;
---

<div style="margin-bottom: 80px;">
    <div class="text-white text-2xl font-bold" style="margin-bottom: 12px; margin-right: 20px;">
        技能樹<hr />
    </div>

    <div class="relative h-86" style="z-index: 2;">
        <div id="android-studio" class="skill-tree-item" style="top: 10%; left: 36%;" balloon-data="Android 應用開發">
            <Border2/>
            
            <div class="icon-container">
                <AndroidStudioIcon className="icon" />
                <b class="icon-text">Android Studio</b>
            </div>
        </div>

        <div id="painting" class="skill-tree-item" style="top: 22%; left: 60%;" balloon-data="手繪">
            <Border2/>
            
            <div class="icon-container">
                <PencilIcon className="icon" />
                <b class="icon-text">Painting</b>
            </div>
        </div>

        <div id="blender" class="skill-tree-item" style="top: 33%; left: 20%;" balloon-data="3D 建模">
            <Border2/>
            
            <div class="icon-container">
                <BlenderIcon className="icon" />
                <b class="icon-text">Blender</b>
            </div>
        </div>

        <div id="solder" class="skill-tree-item" style="top: 45%; left: 78%;" balloon-data="焊接">
            <Border2/>
            
            <div class="icon-container">
                <SolderIcon className="icon" />
                <b class="icon-text">Solder</b>
            </div>
        </div>

        <div id="git" class="skill-tree-item" style="top: 45%; left: 47%;" balloon-data="版本控制">
            <Border2/>
            
            <div class="icon-container">
                <GitIcon className="icon" />
                <b class="icon-text">Git</b>
            </div>
        </div>

        <div id="easy-eda" class="skill-tree-item" style="top: 77%; left: 75%;" balloon-data="PCB Layout">
            <Border2/>
            
            <div class="icon-container">
                <EasyEdaIcon className="icon" />
                <b class="icon-text">Easy EDA</b>
            </div>
        </div>

        <div id="astro" class="skill-tree-item" style="top: 81%; left: 55%;" balloon-data="前端框架">
            <Border2/>

            <div class="icon-container">
                <AstroIcon className="icon" />
                <b class="icon-text">Astro</b>
            </div>
        </div>

        <div id="printer-3d" class="skill-tree-item" style="top: 78%; left: 26%;" balloon-data="3D 列印">
            <Border2/>
            
            <div class="icon-container">
                <Printer3dIcon className="icon" />
                <b class="icon-text">3D Print</b>
            </div>
        </div>

        <div id="vs-code" class="skill-tree-item" style="top: 65%; left: 39%;" balloon-data="功能強大的 IDE">
            <Border2/>

            <div class="icon-container">
                <VsCodeIcon className="icon" />
                <b class="icon-text">VS Code</b>
            </div>
        </div>

        <div id="ultimaker-cura" class="skill-tree-item" style="top: 60%; left: 9%;" balloon-data="切片工具">
            <Border2/>
            
            <div class="icon-container">
                <UltimakerCuraIcon className="icon" />
                <b class="icon-text">Ultimaker Cura</b>
            </div>
            
        </div>

        <svg id="lines" class="absolute top-0 left-0 w-full h-full pointer-events-none" style="z-index: -1;"></svg>
    </div>

    <div class="text-center block" style="color: rgb(160,160,160); width: 92%; font-size: 16px;">
        <b style="font-size: 18px;">[ 技能擴展中... ]</b><br>
        (React | Next.js | STM32CubeIDE)
    </div>

    <div class="skill-describe block lg:flex">
        <ul class="list-disc" style="margin-left: auto; margin-right: auto;">
            <li><b class="text-white">Blender</b> - ✓ 建模，✗ 不會shader，動畫只會一點</li>
            <li><b class="text-white">Ultimaker Cura</b> - 3D 模型切片</li>
            <li><b class="text-white">3D Print</b> - 有相關經驗，使用過 PLA、POM 材質</li>
            <br>
            <li><b class="text-white">Git</b> - 版本控制工具，雖然我很少 push 上 Github</li>
            <li><b class="text-white">VS Code</b> - 我最喜歡，也最常用的 IDE</li>
            <li><b class="text-white">Android Studio</b> - Android 應用程式開發</li>
            <li><b class="text-white">Astro</b> - 前端框架，這個網頁就是 Astro 做的</li>
        </ul>
        <br>

        <ul class="list-disc" style="margin-left: auto; margin-right: auto;">
            <li><b class="text-white">Easy EDA</b> - PCB Layout，目前只畫過 2 層的板子</li>
            <li><b class="text-white">焊接</b> - 擅用洛鐵&吹焊機，可焊 0402、QFN 等小型封裝</li>
            <br>
            <li><b class="text-white">手繪</b> - 素描、色鉛筆</li>
        </ul>
    </div>

</div>

<script>
    const connections = 
    [
        ["android-studio", "git"],
        ["vs-code", "git"],
        ["solder", "easy-eda"],
        ["astro", "vs-code"],
        ["blender", "painting"],
        ["blender", "printer-3d"],
        ["blender", "ultimaker-cura"],
        ["printer-3d", "ultimaker-cura"],
        ["blender", "git"],
        ["git", "easy-eda"],
        ["painting", "easy-eda"],
        ["painting", "android-studio"],
        ["painting", "astro"],
    ];

    function connectAll()
    {
        const svg = document.getElementById("lines") as SVGSVGElement | null;
        if (!svg) return;

        svg.innerHTML = "";
        const svgRect = svg.getBoundingClientRect();

        connections.forEach( ([id1, id2]) => {
            const obj1 = document.getElementById(id1)?.getBoundingClientRect();
            const obj2 = document.getElementById(id2)?.getBoundingClientRect();

            if (!obj1 || !obj2) return;

            const x1 = obj1.left + obj1.width/2  - svgRect.left;
            const y1 = obj1.top  + obj1.height/2 - svgRect.top;
            const x2 = obj2.left + obj2.width/2  - svgRect.left;
            const y2 = obj2.top  + obj2.height/2 - svgRect.top;

            const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", x1.toString());
            line.setAttribute("y1", y1.toString());
            line.setAttribute("x2", x2.toString());
            line.setAttribute("y2", y2.toString());
            line.setAttribute("stroke", "white");
            line.setAttribute("storke-width", "2px");

            svg?.appendChild(line);

        });
    }

    connectAll();
    window.addEventListener("resize", connectAll);
</script>
