---
title: "a017. äº”å‰‡é‹ç®—"
description: ""
date: 2025-05-16
tags: ["cpp"]
---

## è§£æ³•ä¸€ã€éè¿´

### ğŸ”¹ æ ¸å¿ƒï¼šæŠŠå¤§å¼å­æ‹†æˆå°å¼å­

ä¾ç…§ å„ªå…ˆåº¦ç”±ä½è€Œé«˜ã€ç”±å¾Œå¾€å‰ çš„é †åºè™•ç†<br>
`+, -` â†’ `*, /, %` â†’ `(, )`

ç•¶ä¸€å€‹å¼å­æ²’æœ‰ä»»ä½•é‹ç®—ç¬¦è™Ÿ(ä»£è¡¨ä»–åªå‰©æ•¸å­—)ï¼Œè¿”å›æ•¸å€¼<br>
ç•¶ä¸€å€‹å¼å­é‹ç®—å®Œæˆï¼Œè¿”å›æ•¸å€¼

ä¾‹å¦‚æ¸¬è³‡ `12 * 34 * 56 + 78`<br>
`+` æ˜é¡¯éœ€è¦æœ€å¾Œè™•ç†<br>
æ–¼æ˜¯ç”±å¾Œå¾€å‰æ‰¾åˆ° `+` å¾Œ<br>
å°‡å•é¡Œæ‹†æˆ `12 * 34 * 56` + `78` å…©å€‹å¼å­<br>
å…ˆè™•ç†å®Œé€™å…©å€‹å¼å­å¾Œå†è™•ç†åŠ æ³•

éè¿´çš„ä»£ç¢¼å¤§æ¦‚é•·åšé€™æ¨£

```cpp
calculate(int begin, int end){
    // ...
    return calculate(int begin1, int end1) + calculate(int begin2, int end2);
    // ...
    return calculate(int begin1, int end1) * calculate(int begin2, int end2);

    // ...
    return num;
}
```

å®Œæ•´çš„æ­¥é©Ÿæ˜¯ (ä¸­æ‹¬è™Ÿä»£è¡¨å¼å­çš„æ‹†æ³•)

1. æ‹† `+` è™Ÿï¼š`[12 * 34 * 56] + [78]`
2. æ‹† `/` è™Ÿï¼š`[[12 * 34] * 56] + [78]`
3. æ‹† `*` è™Ÿï¼š`[[12 * 34] * 56] + [78]`
4. è¿”å›çµæœï¼š`22926`

å¦å¤–ç”±æ–¼æ‹¬è™Ÿè¦æœ€å¾Œè™•ç†<br>
å› æ­¤éœ€è¦ä¸€å€‹è®Šæ•¸ `layer` ç´€éŒ„ç•¶å‰ä½ç½®æ‹¬è™Ÿçš„å±¤æ•¸<br>
ç•¶å±¤æ•¸æ˜¯ `0` æ™‚ï¼Œæ‰èƒ½è™•è£¡ `+, -, *, /, %`

### âœ… å®Œæ•´ä»£ç¢¼

è©•åˆ†çµæœ(åƒè€ƒ) ï¼š **<font color="#00bb00">AC</font> (2ms, 332KB)**

```cpp
#include <bits/stdc++.h>
using namespace std;
#define int long long

string s;

int s2i(int begin_, int end_){
    int num = 0;
    for (int i=begin_; i<end_; i++) {
        num = num*10 + (s[i]-'0');
    }
    return num;
}

int calculate(int begin_, int end_) {

    if (begin_ >= end_) return 0;

    // handle + -
    int layer = 0;
    for(int i=end_-1; i>=begin_; i--) {
        if(s[i] == ')') layer++;
        else if(s[i] == '(') layer--;
        
        else if((s[i] == '+' || s[i] == '-') && layer == 0) {
            if(s[i] == '+') return calculate(begin_, i-1) + calculate(i+2, end_);
            else return calculate(begin_, i-1) - calculate(i+2, end_);
        }
    }

    // handle * / %
    layer = 0;
    for(int i = end_-1; i>=begin_; i--) {
        if(s[i] == ')') layer++;
        else if(s[i] == '(') layer--;
        
        else if(layer == 0) {
            if(s[i] == '*') return calculate(begin_, i-1) * calculate(i+2, end_);
            if(s[i] == '/') return calculate(begin_, i-1) / calculate(i+2, end_);
            if(s[i] == '%') return calculate(begin_, i-1) % calculate(i+2, end_);
        }
    }

    // handle ( )
    if(s[begin_] == '(' && s[end_-1] == ')') {
        return calculate(begin_+2, end_-2);
    }

    return s2i(begin_, end_);
}

signed main(){
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    
    while(getline(cin, s)) {
        cout << calculate(0, s.size()) << endl;
    }
}
```
